#include <TempMes.h>
void Init_Adc(){
	RCC->AHBENR|=RCC_AHBENR_GPIOAEN;
	GPIOA->MODER|= GPIO_MODER_MODER1;

	RCC->APB2ENR|= RCC_APB2ENR_ADCEN;

	ADC1->ISR|=ADC_ISR_ADRDY;
	ADC1->CR|=ADC_CR_ADEN;
	while(!(ADC_ISR_ADRDY&ADC1->ISR));
	//ADC1->CFGR1;
	ADC1->CFGR2|=ADC_CFGR2_CKMODE_0;
	ADC1->CHSELR|=ADC_CHSELR_CHSEL1 | ADC_CHSELR_CHSEL16;
	ADC1->SMPR|=ADC_SMPR1_SMPR_2;
	ADC->CCR|= ADC_CCR_TSEN;
}
void read_Temp(int16_t& data){
	ADC1->CR|=ADC_CR_ADSTART;
	while(ADC1->ISR&ADC_ISR_EOC);
	data=ADC1->DR;
	while(ADC1->ISR&ADC_ISR_EOC);
	data=ADC1->DR;
}
